import Foundation

class IngredientCategoryManager {
    static let shared = IngredientCategoryManager()
    
    private init() {}
    
    // 食材分类映射
    private let categoryMap: [String: String] = [
        // 蔬菜类
        "白菜": "蔬菜", "萝卜": "蔬菜", "青菜": "蔬菜", "韭菜": "蔬菜",
        "茄子": "蔬菜", "黄瓜": "蔬菜", "西红柿": "蔬菜", "土豆": "蔬菜",
        "胡萝卜": "蔬菜", "芹菜": "蔬菜", "生菜": "蔬菜", "菠菜": "蔬菜",
        "豆芽": "蔬菜", "南瓜": "蔬菜", "冬瓜": "蔬菜", "苦瓜": "蔬菜",
        "丝瓜": "蔬菜", "莴笋": "蔬菜", "蒜苗": "蔬菜", "豆角": "蔬菜",
        "茼蒿": "蔬菜", "油菜": "蔬菜", "空心菜": "蔬菜", "娃娃菜": "蔬菜",
        "小白菜": "蔬菜", "大白菜": "蔬菜", "包菜": "蔬菜", "卷心菜": "蔬菜",
        "花菜": "蔬菜", "西兰花": "蔬菜", "菜花": "蔬菜", "青椒": "蔬菜",
        "番茄": "蔬菜", "小番茄": "蔬菜", "玉米": "蔬菜", "辣椒": "蔬菜",
        "蘑菇": "蔬菜", "大蒜": "蔬菜", "洋葱": "蔬菜", "豌豆": "蔬菜",
        "芦笋": "蔬菜", "紫甘蓝": "蔬菜", "竹笋": "蔬菜", "山药": "蔬菜",
        "莲藕": "蔬菜",
        
        // 水果类
        "苹果": "水果", "青苹果": "水果", "橘子": "水果", "橙子": "水果",
        "香蕉": "水果", "葡萄": "水果", "西瓜": "水果", "桃子": "水果",
        "梨": "水果", "草莓": "水果", "柠檬": "水果", "樱桃": "水果",
        "蓝莓": "水果", "椰子": "水果", "火龙果": "水果", "猕猴桃": "水果",
        "菠萝": "水果", "柚子": "水果", "石榴": "水果", "山竹": "水果",
        "无花果": "水果", "榴莲": "水果", "芒果": "水果", "杨梅": "水果",
        
        // 肉类
        "猪肉": "肉类", "五花肉": "肉类", "猪里脊": "肉类", "猪前腿": "肉类",
        "猪后腿": "肉类", "猪肘": "肉类", "猪蹄": "肉类", "猪排骨": "肉类",
        "猪肋排": "肉类", "猪腩肉": "肉类", "猪梅花肉": "肉类", "猪瘦肉": "肉类",
        "猪肝": "肉类", "猪心": "肉类", "猪肚": "肉类", "猪大肠": "肉类",
        "猪小肠": "肉类", "牛肉": "肉类", "牛里脊": "肉类", "牛排": "肉类",
        "牛腩": "肉类", "牛肋条": "肉类", "牛腱子": "肉类", "牛筋": "肉类",
        "牛肝": "肉类", "牛百叶": "肉类", "牛尾": "肉类", "牛舌": "肉类",
        "牛肚": "肉类", "牛骨": "肉类", "牛肋排": "肉类", "牛板腱": "肉类",
        "牛眼肉": "肉类", "羊肉": "肉类", "羊排": "肉类", "羊腿": "肉类",
        "羊里脊": "肉类", "羊肋排": "肉类", "羊蝎子": "肉类", "羊肝": "肉类",
        "羊肚": "肉类", "羊骨": "肉类", "鸡肉": "肉类", "鸡胸肉": "肉类",
        "鸡翅": "肉类", "鸡腿": "肉类", "鸡翅根": "肉类", "鸡翅中": "肉类",
        "鸡爪": "肉类", "鸡心": "肉类", "鸡肝": "肉类", "鸡胗": "肉类",
        "童子鸡": "肉类", "三黄鸡": "肉类", "鸭肉": "肉类", "鸭胸肉": "肉类",
        "鸭腿": "肉类", "鸭翅": "肉类", "鸭舌": "肉类", "鸭肝": "肉类",
        "鸭胗": "肉类", "北京烤鸭": "肉类", "鹅肉": "肉类", "鹅胸肉": "肉类",
        "鹅腿": "肉类", "鹅肝": "肉类", "鹅翅": "肉类", "兔肉": "肉类",
        "兔腿": "肉类", "兔里脊": "肉类", "火腿": "肉类", "香肠": "肉类",
        "培根": "肉类", "腊肠": "肉类", "腊肉": "肉类", "熏肉": "肉类",
        "肉松": "肉类", "肉脯": "肉类",
        
        // 海鲜类
        "虾": "海鲜", "龙虾": "海鲜", "螃蟹": "海鲜", "鱼": "海鲜",
        "三文鱼": "海鲜", "带鱼": "海鲜", "鲍鱼": "海鲜", "生蚝": "海鲜",
        "鱿鱼": "海鲜", "章鱼": "海鲜", "海参": "海鲜", "鳗鱼": "海鲜",
        "扇贝": "海鲜", "海蜇": "海鲜", "海带": "海鲜", "紫菜": "海鲜",

        // 调味料类
        "盐": "调味料", "糖": "调味料", "酱油": "调味料", "醋": "调味料",
        "料酒": "调味料", "花椒": "调味料", "八角": "调味料", "辣椒粉": "调味料",
        "蒜粉": "调味料", "姜": "调味料", "芝麻": "调味料", "芥末": "调味料",
        "番茄酱": "调味料", "蚝油": "调味料", "生抽": "调味料", "老抽": "调味料",
        "白胡椒": "调味料", "黑胡椒": "调味料", "五香粉": "调味料", "十三香": "调味料",
        "味精": "调味料", "鸡精": "调味料", "豆瓣酱": "调味料", "甜面酱": "调味料",
        "海鲜酱": "调味料", "辣椒酱": "调味料", "芝麻酱": "调味料", "花生酱": "调味料",
        "咖喱粉": "调味料", "孜然": "调味料", "香叶": "调味料", "桂皮": "调味料",

        // 蛋类
        "鸡蛋": "蛋类", "鸭蛋": "蛋类", "鹅蛋": "蛋类", "皮蛋": "蛋类",
        "咸蛋": "蛋类", "茶叶蛋": "蛋类", "咸鸭蛋": "蛋类", "鹌鹑蛋": "蛋类",

        // 乳制品
        "牛奶": "乳制品", "奶酪": "乳制品", "黄油": "乳制品",
        "酸奶": "乳制品", "奶油": "乳制品", "芝士": "乳制品",

        // 坚果类
        "花生": "坚果", "瓜子仁": "坚果", "核桃": "坚果", "杏仁": "坚果",
        "腰果": "坚果", "开心果": "坚果", "榛子": "坚果", "松子": "坚果",
        "白果": "坚果", "瓜子": "坚果",

        // 主食类
        "面包": "主食", "米饭": "主食", "面条": "主食", "饺子": "主食",
        "馒头": "主食", "包子": "主食", "三明治": "主食", "汉堡": "主食",
        "披萨": "主食", "粽子": "主食", "寿司": "主食", "春卷": "主食",
        "炒饭": "主食", "炒面": "主食",

        // 零食和甜点
        "饼干": "零食", "薯片": "零食", "巧克力": "零食", "蛋糕": "零食",
        "冰淇淋": "零食", "甜甜圈": "零食", "棒棒糖": "零食", "糖果": "零食",
        "爆米花": "零食", "布丁": "零食", "月饼": "零食", "麻花": "零食",
        "果冻": "零食",

        // 饮料类
        "咖啡": "饮料", "茶": "饮料", "啤酒": "饮料", "果汁": "饮料",
        "可乐": "饮料", "红酒": "饮料", "白酒": "饮料", "奶茶": "饮料",
        "椰汁": "饮料", "豆浆": "饮料", "矿泉水": "饮料"
    ]
    
    // 主要类别列表
    private let mainCategories = ["蔬菜", "水果", "肉类", "海鲜", "调味料", "蛋类", "乳制品", "坚果", "主食", "零食", "饮料", "其他"]
    
    // 获取食材的分类
    func getCategory(for ingredient: String) -> String {
        // 先检查是否是主类别
        if mainCategories.contains(ingredient) {
            return ingredient
        }
        
        // 处理输入字符串
        let trimmedIngredient = ingredient.trimmingCharacters(in: .whitespacesAndNewlines)
        
        // 直接匹配
        if let category = categoryMap[trimmedIngredient] {
            return category
        }
        
        // 模糊匹配：检查是否包含关键词
        for (key, value) in categoryMap {
            if trimmedIngredient.contains(key) || key.contains(trimmedIngredient) {
                return value
            }
        }
        
        return "其他"  // 默认返回"其他"类别
    }
    
    // 获取主要类别
    func getMainCategory(for category: String) -> String {
        // 如果本身就是主类别，直接返回
        if mainCategories.contains(category) {
            return category
        }
        
        // 否则尝试从映射中获取
        return categoryMap[category] ?? "其他"
    }
    
    // 获取所有主要类别
    var categories: [String] {
        return mainCategories
    }
}